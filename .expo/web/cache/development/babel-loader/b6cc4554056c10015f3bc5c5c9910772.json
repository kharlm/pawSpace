{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nvar _jsxFileName = \"/Users/kharl/pawSpace/screens/Match.js\";\nimport React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport { getDog, getDogs, getLocation } from \"../actions/dog\";\nimport { getUser } from \"../actions/user\";\nimport Card from \"./Card\";\nimport * as firebase from 'firebase';\nimport SwipeCards from 'react-native-swipe-cards';\nimport db from \"../config/firebase\";\n\nvar _Dimensions$get = Dimensions.get('window'),\n    width = _Dimensions$get.width,\n    height = _Dimensions$get.height;\n\nvar BOTTOM_BAR_HEIGHT = !Platform.isPad ? 29 : 49;\n\nvar Match = function (_Component) {\n  _inherits(Match, _Component);\n\n  function Match(props) {\n    var _this;\n\n    _classCallCheck(this, Match);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Match).call(this, props));\n\n    _this.goToDog = function (card) {\n      console.log(\"INSIDE GO TO DOG\");\n\n      _this.props.getDog(card.dogId);\n\n      _this.props.navigation.navigate('Profile');\n    };\n\n    _this.Alert = function () {\n      Alert.alert('Swipe Screen', 'Swipe right to Like a dog or Swipe left to dislike a dog', [{\n        text: 'OK'\n      }], {\n        cancelable: false\n      });\n    };\n\n    _this.checkMatch = function _callee(card) {\n      var otherDog, query1, res, index, i, me, user;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"Im in check match\");\n              otherDog = [];\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(db.collection('dogs').where('dogId', '==', card.dogId).get());\n\n            case 4:\n              query1 = _context.sent;\n              query1.forEach(function (response) {\n                otherDog.push(response.data());\n              });\n              res = JSON.stringify(otherDog[0].swipes);\n\n              for (i = 0; i < otherDog[0].swipes.length; i++) {\n                if (Object.keys(otherDog[0].swipes[i])[0] === _this.props.dog.dogId) {\n                  index = i;\n                  console.log(\"index: \" + index);\n\n                  if (Object.values(otherDog[0].swipes[index])[0] === true) {\n                    _this.props.navigation.navigate('ItsAMatch', {\n                      card: card\n                    });\n\n                    console.log(\"EQUIVALENT\");\n                    console.log(\"my dog id: \" + _this.props.dog.dogId);\n                    console.log(\"Their dog id: \" + card.dogId);\n                    me = {\n                      id: _this.props.dog.dogId,\n                      photoUrl: _this.props.dog.photo,\n                      name: _this.props.dog.dogname\n                    };\n                    user = {\n                      id: card.dogId,\n                      photoUrl: card.photo,\n                      name: card.dogname\n                    };\n                    db.collection('dogs').doc(_this.props.dog.dogId).update({\n                      chat: firebase.firestore.FieldValue.arrayUnion({\n                        user: user\n                      })\n                    });\n                    db.collection('dogs').doc(card.dogId).update({\n                      chat: firebase.firestore.FieldValue.arrayUnion({\n                        me: me\n                      })\n                    });\n                  }\n                }\n              }\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Match, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.getLocation(this.props.dog);\n      console.log(\"uid: \" + this.props.user.uid);\n      this.props.getDog;\n      this.props.getDogs(this.props.dog);\n      this.Alert();\n    }\n  }, {\n    key: \"handleYup\",\n    value: function handleYup(card) {\n      console.log(\"id \" + card.dogId);\n      db.collection('dogs').doc(this.props.dog.dogId).update({\n        swipes: firebase.firestore.FieldValue.arrayUnion(_defineProperty({}, card.dogId, true))\n      });\n      this.checkMatch(card);\n    }\n  }, {\n    key: \"handleNope\",\n    value: function handleNope(card) {\n      console.log(\"in hadnle\");\n      db.collection('dogs').doc(this.props.dog.dogId).update({\n        swipes: firebase.firestore.FieldValue.arrayUnion(_defineProperty({}, card.dogId, false))\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.props.cards === null) return null;\n      return React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        }\n      }, React.createElement(View, {\n        style: {\n          flexDirection: 'row'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate(\"MatchProfile\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        }\n      }, React.createElement(Text, {\n        style: styles.cardButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        }\n      }, \"Profile\")), React.createElement(Text, {\n        style: {\n          paddingRight: width * .5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        }\n      }), React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate(\"MatchesScreen\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        }\n      }, React.createElement(Text, {\n        style: styles.cardButton,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        }\n      }, \"Matches\"))), React.createElement(SwipeCards, {\n        cards: this.props.cards.cards,\n        stack: false,\n        renderCard: function renderCard(cardData) {\n          return React.createElement(Card, _extends({}, cardData, {\n            navigation: _this2.props.navigation,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 167\n            }\n          }));\n        },\n        renderNoMoreCards: function renderNoMoreCards() {\n          return React.createElement(NoMoreCards, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 168\n            }\n          });\n        },\n        showYup: false,\n        showNope: false,\n        handleYup: this.handleYup.bind(this),\n        handleNope: this.handleNope.bind(this),\n        onClickHandler: this.goToDog.bind(this),\n        hasMaybeAction: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        }\n      }));\n    }\n  }]);\n\n  return Match;\n}(Component);\n\nvar NoMoreCards = function (_React$Component) {\n  _inherits(NoMoreCards, _React$Component);\n\n  function NoMoreCards() {\n    _classCallCheck(this, NoMoreCards);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(NoMoreCards).apply(this, arguments));\n  }\n\n  _createClass(NoMoreCards, [{\n    key: \"render\",\n    value: function render() {\n      console.log('in no more cards');\n      return React.createElement(View, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        }\n      }, React.createElement(Text, {\n        style: {\n          position: 'absolute',\n          left: -150,\n          bottom: -(height * .3),\n          fontSize: 20,\n          fontWeight: 'bold',\n          color: '#000'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        }\n      }, \"There are no more dogs to swipe\"));\n    }\n  }]);\n\n  return NoMoreCards;\n}(React.Component);\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    getDog: getDog,\n    getDogs: getDogs,\n    getLocation: getLocation,\n    getUser: getUser\n  }, dispatch);\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    post: state.post,\n    user: state.user,\n    userprofile: state.profile,\n    dog: state.dog,\n    cards: state.cards\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Match);","map":{"version":3,"sources":["/Users/kharl/pawSpace/screens/Match.js"],"names":["React","Component","connect","bindActionCreators","getDog","getDogs","getLocation","getUser","Card","firebase","SwipeCards","db","Dimensions","get","width","height","BOTTOM_BAR_HEIGHT","Platform","isPad","Match","props","goToDog","card","console","log","dogId","navigation","navigate","Alert","alert","text","cancelable","checkMatch","otherDog","collection","where","query1","forEach","response","push","data","res","JSON","stringify","swipes","i","length","Object","keys","dog","index","values","me","id","photoUrl","photo","name","dogname","user","doc","update","chat","firestore","FieldValue","arrayUnion","uid","cards","flexDirection","styles","cardButton","paddingRight","cardData","handleYup","bind","handleNope","NoMoreCards","position","left","bottom","fontSize","fontWeight","color","mapDispatchToProps","dispatch","mapStateToProps","state","post","userprofile","profile"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { View, Text, StyleSheet, Image, Dimensions, Platform,TouchableOpacity,Alert, TouchableHighlight} from \"react-native\";\nimport {getDog,getDogs,getLocation} from '../actions/dog'\nimport{getUser} from '../actions/user'\nimport Card from './Card';\nimport * as firebase from 'firebase';\n\nimport SwipeCards from 'react-native-swipe-cards'\nimport db from '../config/firebase';\nconst { width,height } = Dimensions.get('window');\nconst BOTTOM_BAR_HEIGHT = !Platform.isPad ? 29 : 49 // found from https://stackoverflow.com/a/50318831/6141587\n\nclass Match extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount() {\n   \n   \n    this.props.getLocation(this.props.dog)\n    console.log(\"uid: \"+this.props.user.uid)\n    this.props.getDog\n    this.props.getDogs(this.props.dog)\n    this.Alert()\n    \n   }\n  /* componentWillMount = () => {\n   \n    this.props.getDog\n    //this.props.getLocation(this.props.dog)\n   this.props.getDogs(this.props.dog)\n    \n   }\n   */\n\n   goToDog = (card) => {\n    console.log(\"INSIDE GO TO DOG\")\n    this.props.getDog(card.dogId)\n    this.props.navigation.navigate('Profile')\n  }\n\n   Alert = () => {\n\n    Alert.alert(\n      'Swipe Screen',\n      'Swipe right to Like a dog or Swipe left to dislike a dog',\n      [\n        \n        {text: 'OK'},\n      ],\n      { cancelable: false }\n  )}\n\n   checkMatch = async (card) => {\n     console.log(\"Im in check match\")\n     let otherDog = []\n\n     const query1 = await db.collection('dogs').where('dogId', '==', card.dogId).get()\n      \n      query1.forEach(function(response) {\n        otherDog.push(response.data())\n        })\n\n        let res = JSON.stringify(otherDog[0].swipes)\n       \n       \n       \n     \n        \n        \n        //check if dog is in swipes array and if it is then check if the value is true\n          let index;\n          for(let i = 0; i < otherDog[0].swipes.length; i++) {\n            if(Object.keys(otherDog[0].swipes[i])[0]===this.props.dog.dogId){\n              \n              index = i\n              console.log(\"index: \"+index)\n              if(Object.values(otherDog[0].swipes[index])[0]===true){\n                this.props.navigation.navigate('ItsAMatch',{ card: card })\n                console.log(\"EQUIVALENT\")\n                console.log(\"my dog id: \"+this.props.dog.dogId)\n                console.log(\"Their dog id: \"+card.dogId)\n                var me = {\n                  id: this.props.dog.dogId,\n                  photoUrl: this.props.dog.photo,\n                  name: this.props.dog.dogname\n                }\n                var user = {\n                  id: card.dogId,\n                  photoUrl: card.photo,\n                  name: card.dogname\n                }\n\n                db.collection('dogs').doc(this.props.dog.dogId).update({\n                  chat: firebase.firestore.FieldValue.arrayUnion({\n                    user\n                  }\n                  )\n                })\n\n                db.collection('dogs').doc(card.dogId).update({\n                  chat: firebase.firestore.FieldValue.arrayUnion({\n                    me\n                  }\n                  )\n                })\n              }\n       }\n          \n      }\n    }\n\n\n    \n \n\n   handleYup (card) {\n    \n    console.log(\"id \"+card.dogId)\n    db.collection('dogs').doc(this.props.dog.dogId).update({\n      swipes: firebase.firestore.FieldValue.arrayUnion({\n\t\t    [card.dogId]: true\n      }\n      )\n      \n    })\n    \n    \n   this.checkMatch(card)\n  }\n\n  handleNope (card) {\n    console.log(\"in hadnle\")\n    db.collection('dogs').doc(this.props.dog.dogId).update({\n      swipes: firebase.firestore.FieldValue.arrayUnion({\n\t\t    [card.dogId]: false\n      }\n      )\n      \n    })\n  }\n\n   \n  render() {\n    if(this.props.cards===null) return null\n\n    return (\n      <View>\n      <View style={{flexDirection:'row'}}>\n        <TouchableOpacity  onPress={() => this.props.navigation.navigate(\"MatchProfile\")}>\n      <Text style={styles.cardButton}>Profile</Text>\n      </TouchableOpacity>\n     <Text style={{paddingRight:width*.5}}></Text>\n      <TouchableOpacity  onPress={() => this.props.navigation.navigate(\"MatchesScreen\")}>\n      <Text style={styles.cardButton}>Matches</Text>\n      </TouchableOpacity>\n      \n      </View>\n    \n      \n      <SwipeCards\n        cards={this.props.cards.cards}\n        stack={false}\n        renderCard={(cardData) => <Card {...cardData} navigation={this.props.navigation}/>}\n        renderNoMoreCards={() => <NoMoreCards />}\n        showYup={false}\n        showNope={false}\n        handleYup={this.handleYup.bind(this)}\n        handleNope={this.handleNope.bind(this)}\n        onClickHandler={this.goToDog.bind(this)}\n        hasMaybeAction={false}\n        />\n       \n        \n        \n       \n       \n\n        </View>\n    )\n\n    /*let dog = {}\n    dog= this.props.dog\n   \n    return (\n     <Card\n     title= {dog.dogname}\n     caption= {dog.breed}\n     image = {dog.photo}\n     />\n    );\n    */\n  }\n  \n}\n\nclass NoMoreCards extends React.Component {\n  render() {\n    console.log('in no more cards')\n    return (\n      <View>\n      <Text style={{position: 'absolute',\n      left: -150 ,\n      bottom: -(height*.3),\n      fontSize: 20,\n      fontWeight: 'bold',\n      color: '#000'}}>There are no more dogs to swipe</Text>\n    </View>\n    )\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return bindActionCreators({getDog,getDogs,getLocation,getUser}, dispatch)\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    post: state.post,\n    user: state.user,\n    userprofile: state.profile,\n    dog: state.dog,\n    cards: state.cards\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Match)"]},"metadata":{},"sourceType":"module"}